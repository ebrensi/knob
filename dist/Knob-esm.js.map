{"mappings":"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","sources":["src/Knob.ts","src/handleChange.ts"],"sourcesContent":["import { handleChange } from \"./handleChange\";\n\nconst DEBOUNCE_DELAY = 10; // ms\n\ntype CursorType = boolean | number;\n\nconst DefaultOptions = {\n  value: 50,\n\n  min: 0,\n  max: 100,\n  step: 1,\n\n  cursor: <CursorType>false,\n  thickness: 0.35,\n  lineCap: <CanvasRenderingContext2D[\"lineCap\"]>\"butt\",\n  readOnly: false,\n  displayInput: true,\n\n  width: 200,\n  height: 200,\n\n  bgColor: \"#EEEEEE\",\n  fgColor: \"#87CEEB\",\n  label: \"\",\n  labelColor: \"#888\",\n\n  angleOffset: 0,\n  angleArc: 360,\n\n  className: \"\",\n  activeClass: \"\",\n};\n\nexport type KnobOptions = typeof DefaultOptions\n\ntype KnobProperties = {\n  options: KnobOptions;\n  canvas: HTMLCanvasElement;\n  input: HTMLInputElement;\n  label: HTMLSpanElement;\n  value: number;\n  getValue: () => number;\n  setValue: (value: number, event?: boolean) => void;\n}\n\ntype ProtoKnob = Partial<KnobProperties> & HTMLDivElement\nexport type KnobElement = KnobProperties & HTMLDivElement\n\nexport function Knob(knobOptions: Partial<KnobOptions>): KnobElement {\n  const options = { ...DefaultOptions, ...knobOptions };\n\n  // Create Canvas Element\n  const canvas = document.createElement(\"canvas\");\n  canvas.height = options.height;\n  canvas.width = options.width;\n  canvas.style.position = \"absolute\";\n  const ctx = <CanvasRenderingContext2D>canvas.getContext(\"2d\");\n\n  // Create Input Element\n  const fontScale =\n    Math.max(\n      String(Math.abs(options.max)).length,\n      String(Math.abs(options.min)).length,\n      2\n    ) + 2;\n\n  const input = document.createElement(\"input\");\n  input.value = String(options.value);\n  input.disabled = options.readOnly;\n\n  const lineWidth = (options.width / 2) * options.thickness;\n\n  Object.assign(input.style, {\n    position: \"absolute\",\n    top: `${options.width / 2 - options.width / 7}px`,\n    left: `${lineWidth}px`,\n    width: `${options.width - lineWidth * 2}px`,\n    \"vertical-align\": \"middle\",\n    border: 0,\n    background: \"none\",\n    font: `bold ${(options.width / fontScale) >> 0}px Arial`,\n    \"text-align\": \"center\",\n    color: options.fgColor,\n    padding: \"0px\",\n    \"-webkit-appearance\": \"none\",\n    display: !options.displayInput ? \"none\" : \"\",\n  });\n\n  // Create Label Element\n  const label = document.createElement(\"span\");\n  Object.assign(label.style, {\n    color: options.labelColor,\n    position: \"absolute\",\n    bottom: 0,\n    \"font-size\": \"80%\",\n    \"text-align\": \"center\",\n    \"pointer-events\": \"none\",\n    top: `${options.width / 2 + options.width / 8 - 3}px`,\n    left: 0,\n    right: 0,\n  });\n  label.innerHTML = options.label;\n\n  // Create div element\n  const div: ProtoKnob = document.createElement(\"div\");\n  Object.assign(div.style, {\n    display: \"inline-block\",\n    position: \"relative\",\n    height: `${options.height}px`,\n    width: `${options.width}px`,\n    \"touch-action\": \"none\",\n  });\n  if (options.className) {\n    div.classList.add(options.className);\n  }\n\n  div.appendChild(canvas);\n  div.appendChild(input);\n  div.appendChild(label);\n\n  // Attach HTML Elements to the div element\n  Object.assign(div, { options, canvas, input, label });\n\n  let renderedValue = options.value;\n  let animating = false;\n  let _timeout: number\n\n  function refreshCanvas() {\n    if (renderedValue === options.value) {\n      animating = false;\n    } else {\n      animating = true;\n      renderedValue = options.value;\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      draw(options, ctx);\n      input.value = String(options.value);\n      window.requestAnimationFrame(refreshCanvas);\n    }\n  }\n\n  // Attach methods to the div\n  div.getValue = () => options.value;\n\n  div.setValue = (value: number, event?: boolean) => {\n    value = Math.min(options.max, Math.max(options.min, value));\n    options.value = value;\n    div.value = value;\n    if (!animating) {\n      refreshCanvas();\n    }\n    if (event === true && div.onchange) {\n      /*\n       * Perform debounced callback\n       */\n      let timeout = _timeout;\n      window.clearTimeout(timeout);\n      timeout = window.setTimeout(div.onchange, DEBOUNCE_DELAY);\n      _timeout = timeout;\n    }\n  };\n\n  input.addEventListener(\"change\", (e) => {\n    const el = <HTMLInputElement>e.target;\n    div.setValue?.(+el.value);\n  });\n\n  draw(options, ctx);\n\n  if (!options.readOnly) {\n    handleChange(<KnobElement>div);\n  }\n\n  return <KnobElement>div;\n}\n\nfunction draw(options: KnobOptions, ctx: CanvasRenderingContext2D) {\n  // deg to rad\n  const angleOffset = (options.angleOffset * Math.PI) / 180;\n  const angleArc = (options.angleArc * Math.PI) / 180;\n\n  const angle =\n    ((options.value - options.min) * angleArc) / (options.max - options.min);\n\n  const xy = options.width / 2;\n  const lineWidth = xy * options.thickness;\n  const radius = xy - lineWidth / 2;\n\n  const startAngle = 1.5 * Math.PI + angleOffset;\n  const endAngle = 1.5 * Math.PI + angleOffset + angleArc;\n\n  let startAt = startAngle;\n  let endAt = startAt + angle;\n\n  if (options.cursor) {\n    const cursorSize =\n      options.cursor === true ? options.thickness : options.cursor;\n    const cursorExt = cursorSize / 100 || 1;\n    startAt = endAt - cursorExt;\n    endAt = endAt + cursorExt;\n  }\n\n  ctx.lineWidth = lineWidth;\n  ctx.lineCap = options.lineCap;\n\n  ctx.beginPath();\n  ctx.strokeStyle = options.bgColor;\n  ctx.arc(xy, xy, radius, endAngle, startAngle, true);\n  ctx.stroke();\n\n  ctx.beginPath();\n  ctx.strokeStyle = options.fgColor;\n  ctx.arc(xy, xy, radius, startAt, endAt, false);\n  ctx.stroke();\n}\n","import type { KnobElement, KnobOptions } from \"./Knob\";\n\nexport function handleChange(knob: KnobElement) {\n  const D_listen = document.addEventListener;\n  const D_mute = document.removeEventListener;\n  const canvas = <HTMLCanvasElement>knob.canvas;\n  const options = <KnobOptions>knob.options;\n  const activeClass = options.activeClass;\n\n  canvas.onpointerdown = function (e: PointerEvent) {\n    e.preventDefault();\n    const offset = getOffset(canvas);\n\n    function pointerMove(e: PointerEvent) {\n      knob.setValue(xyToValue(options, e.pageX, e.pageY, offset), true);\n    }\n\n    function pointerUp(e: PointerEvent) {\n      if (activeClass) {\n        knob.classList.remove(activeClass);\n      }\n      D_mute(\"pointermove\", pointerMove);\n      D_mute(\"pointerup\", pointerUp);\n    }\n\n    if (activeClass) {\n      knob.classList.add(activeClass);\n    }\n\n    D_listen(\"pointermove\", pointerMove);\n    D_listen(\"pointerup\", pointerUp);\n\n    pointerMove(e);\n  };\n}\n\ntype point2D = { x: number; y: number };\nfunction xyToValue(\n  options: KnobOptions,\n  x: number,\n  y: number,\n  offset: point2D\n) {\n  const PI2 = 2 * Math.PI;\n  const w2 = options.width / 2;\n  const angleArc = (options.angleArc * Math.PI) / 180;\n  const angleOffset = (options.angleOffset * Math.PI) / 180;\n\n  let angle =\n    Math.atan2(x - (offset.x + w2), -(y - offset.y - w2)) - angleOffset;\n\n  if (angleArc !== PI2 && angle < 0 && angle > -0.5) {\n    angle = 0;\n  } else if (angle < 0) {\n    angle += PI2;\n  }\n\n  const result =\n    ~~(0.5 + (angle * (options.max - options.min)) / angleArc) + options.min;\n  return Math.max(Math.min(result, options.max), options.min);\n}\n\nfunction getOffset(el: HTMLCanvasElement) {\n  const result: point2D = { x: 0, y: 0 };\n  while (el) {\n    result.x += el.offsetLeft;\n    result.y += el.offsetTop;\n    el = <HTMLCanvasElement>el.offsetParent;\n  }\n\n  return result;\n}\n"],"names":[],"version":3,"file":"Knob-esm.js.map"}